ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªé”™è¯¯ä¿¡æ¯çš„æ„æ€æ˜¯ï¼š**ä½ çš„ Git è¢«é…ç½®ä¸ºåœ¨æ¯æ¬¡æäº¤ï¼ˆcommitï¼‰æ—¶è¿è¡Œä¸€ä¸ªåä¸º `pre-commit` çš„ä»£ç æ£€æŸ¥å·¥å…·ï¼Œä½†å®ƒåœ¨å½“å‰è¿™ä¸ªé¡¹ç›®ä¸­æ‰¾ä¸åˆ°è¯¥å·¥å…·çš„é…ç½®æ–‡ä»¶ (`.pre-commit-config.yaml`)ï¼Œå› æ­¤é˜»æ­¢äº†ä½ çš„æäº¤ã€‚**

è¿™ä¸ª `pre-commit` å·¥å…·å°±åƒä¸€ä¸ªä»£ç è´¨é‡çš„â€œå®ˆé—¨å‘˜â€ ğŸ§ã€‚

---

## è¯¦ç»†è§£é‡Š

### ä»€ä¹ˆæ˜¯ `pre-commit`ï¼Ÿ

`pre-commit` æ˜¯ä¸€ä¸ªå¼€å‘å·¥å…·ï¼Œå®ƒå¯ä»¥åœ¨ä½ æ‰§è¡Œ `git commit` å‘½ä»¤ä¹‹åã€ä½† Git æ­£å¼åˆ›å»ºæäº¤è®°å½•**ä¹‹å‰**ï¼Œè‡ªåŠ¨è¿è¡Œä¸€äº›é¢„è®¾çš„æ£€æŸ¥è„šæœ¬ã€‚

- **ç›®çš„**ï¼šè‡ªåŠ¨æ£€æŸ¥ä»£ç æ ¼å¼ã€è¯­æ³•é”™è¯¯ã€ä»£ç é£æ ¼ç­‰ï¼Œç¡®ä¿æäº¤åˆ°ä»“åº“çš„ä»£ç è´¨é‡ã€‚
    
- **å·¥ä½œæ–¹å¼**ï¼šå®ƒé€šè¿‡ä¸€ä¸ªåä¸º `.pre-commit-config.yaml` çš„é…ç½®æ–‡ä»¶æ¥å¾—çŸ¥éœ€è¦è¿è¡Œå“ªäº›æ£€æŸ¥ã€‚
    

### ä¸ºä»€ä¹ˆä¼šçœ‹åˆ°è¿™ä¸ªé”™è¯¯ï¼Ÿ

ä½ çœ‹åˆ°è¿™ä¸ªé”™è¯¯ï¼Œè¯´æ˜ä½ çš„å¼€å‘ç¯å¢ƒä¸­å·²ç»å®‰è£…äº† `pre-commit` å¹¶å°†å…¶è®¾ç½®ä¸ºäº† Git é’©å­ï¼ˆhookï¼‰ã€‚å½“ä½ è¯•å›¾æäº¤æ—¶ï¼Œå‘ç”Ÿäº†ä»¥ä¸‹äº‹æƒ…ï¼š

1. ä½ è¿è¡Œäº† `git commit` å‘½ä»¤ã€‚
    
2. Git è‡ªåŠ¨è§¦å‘äº† `pre-commit` é’©å­ã€‚
    
3. `pre-commit` å·¥å…·å¼€å§‹å·¥ä½œï¼Œå®ƒåœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•å¯»æ‰¾å®ƒçš„æŒ‡ä»¤æ–‡ä»¶â€”â€”`.pre-commit-config.yaml`ã€‚
    
4. å®ƒ**æ²¡æœ‰æ‰¾åˆ°**è¿™ä¸ªæ–‡ä»¶ï¼Œä¸çŸ¥é“è¯¥æ‰§è¡Œå“ªäº›æ£€æŸ¥ï¼Œäºæ˜¯å°±æŠ¥é”™å¹¶ä¸­æ–­äº†æäº¤è¿‡ç¨‹ã€‚
    

è¿™é€šå¸¸å‘ç”Ÿåœ¨ä½ å…‹éš†äº†ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæˆ–è€…åœ¨ä¸€ä¸ªæ²¡æœ‰é…ç½® `pre-commit` çš„æ—§é¡¹ç›®é‡Œï¼Œè€Œä½ çš„ Git å´å…¨å±€æˆ–å±€éƒ¨å®‰è£…äº†å®ƒçš„é’©å­ã€‚

---

## å¦‚ä½•è§£å†³ï¼Ÿ

ä½ æœ‰ä»¥ä¸‹å‡ ç§é€‰æ‹©ï¼Œå…·ä½“å–å†³äºä½ çš„ç›®çš„ï¼š

### æ–¹æ¡ˆä¸€ï¼šä¸ºé¡¹ç›®é…ç½® `pre-commit` (æ¨è)

å¦‚æœä½ å¸Œæœ›åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ä»£ç è‡ªåŠ¨æ£€æŸ¥åŠŸèƒ½ï¼Œé‚£ä¹ˆä½ åº”è¯¥åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚

1. åœ¨ä½ çš„é¡¹ç›®**æ ¹ç›®å½•**ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `.pre-commit-config.yaml` çš„æ–‡ä»¶ã€‚
    
2. åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä½ éœ€è¦çš„æ£€æŸ¥è§„åˆ™ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®ƒä¼šè‡ªåŠ¨ä¿®æ­£è¡Œå°¾å¤šä½™çš„ç©ºæ ¼ï¼š
    
    YAML
    
    ```
    repos:
    -   repo: https://github.com/pre-commit/pre-commit-hooks
        rev: v4.6.0
        hooks:
        -   id: trailing-whitespace
        -   id: end-of-file-fixer
    ```
    
3. ä¿å­˜æ–‡ä»¶åï¼Œé‡æ–°æ‰§è¡Œä½ çš„ `git commit` å‘½ä»¤å³å¯ã€‚
    

### æ–¹æ¡ˆäºŒï¼šä¸´æ—¶è·³è¿‡æ£€æŸ¥ (ç”¨äºå•æ¬¡æäº¤)

å¦‚æœä½ åªæ˜¯æƒ³**è¿™ä¸€æ¬¡**æäº¤æ—¶è·³è¿‡æ£€æŸ¥ï¼Œå¹¶ä¸æƒ³ä¿®æ”¹é¡¹ç›®é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨ Git çš„ `--no-verify` å‚æ•°ã€‚

Bash

```
git commit --no-verify -m "Your commit message"
```

æˆ–è€…ï¼Œé’ˆå¯¹ä½ åŸæ¥ä½¿ç”¨çš„é‚£ä¸ªå¤æ‚å‘½ä»¤ï¼š

Bash

```
git -c user.useConfigOnly=true commit --quiet --allow-empty-message --file - --no-verify
```

**è¿™ä¸ªæ–¹æ³•ä¼šè·³è¿‡æ‰€æœ‰çš„ pre-commit å’Œ commit-msg é’©å­ï¼Œæ˜¯ä¸´æ—¶çš„â€œå¼ºåˆ¶é€šè¡Œè¯â€ã€‚**

### æ–¹æ¡ˆä¸‰ï¼šåœ¨è¿™ä¸ªé¡¹ç›®ä¸­æ°¸ä¹…ç¦ç”¨ `pre-commit`

å¦‚æœä½ ç¡®å®šè¿™ä¸ªé¡¹ç›®**å®Œå…¨ä¸éœ€è¦** `pre-commit` å·¥å…·ï¼Œä½ å¯ä»¥å°†å®ƒä»è¿™ä¸ªé¡¹ç›®çš„ Git é’©å­ä¸­å¸è½½ã€‚

åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

Bash

```
pre-commit uninstall
```

è¿™ä¸ªå‘½ä»¤åªä¼šå½±å“å½“å‰é¡¹ç›®ï¼Œä¸ä¼šå½±å“å…¶ä»–é…ç½®äº† `pre-commit` çš„é¡¹ç›®ã€‚

---

**æ€»ç»“ä¸€ä¸‹ï¼š**

- **æƒ³ç”¨å®ƒ** -> åˆ›å»º `.pre-commit-config.yaml` æ–‡ä»¶ (æ–¹æ¡ˆä¸€)ã€‚
    
- **å°±è¿™æ¬¡ä¸æƒ³ç”¨å®ƒ** -> åœ¨ `git commit` å‘½ä»¤ååŠ ä¸Š `--no-verify` (æ–¹æ¡ˆäºŒ)ã€‚
    
- **åœ¨è¿™ä¸ªé¡¹ç›®é‡Œæ°¸è¿œä¸æƒ³ç”¨å®ƒ** -> è¿è¡Œ `pre-commit uninstall` (æ–¹æ¡ˆä¸‰)ã€‚