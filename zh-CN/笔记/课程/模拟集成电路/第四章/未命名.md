## 📖 第 3 章 单级放大器：性能的突破与极限 (二)

> **【学习导言】**
>
> 欢迎来到本章的第二部分。在上一部分，我们研究了基本的共源（CS）、共栅（CG）和共漏（CD）放大器。它们各有优缺点，但都面临一个共同的性能瓶颈：**输出电阻不够高，或高频性能受限**。
>
> 本章的叙事主线将围绕一个核心问题展开：**我们如何突破单管的性能极限，在不引入额外电容的前提下，实现极高的增益和带宽？** 答案就是 **“Cascode”**，一种巧妙的管子堆叠艺术。

---

### 3.5 共源共栅电流镜 (Cascode Current Mirror)

#### 3.5.1 为什么要使用 Cascode 结构？（痛点分析）

**【背景故事/痛点】** 传统电流镜（如**图 4a** 所示）作为电路中的“电流标尺”，其最重要的性能指标是**精度**和**输出电阻 $R_{out}$**。
1.  **精度问题 (Channel Length Modulation, $\lambda$)：** 理想情况下，输出电流 $I_{OUT}$ 应该精确等于参考电流 $I_{REF}$。然而，由于输出端的 $V_{DS2}$ 会随着负载变化，**沟道长度调制效应** ($\lambda$) 会导致 $I_{OUT}$ 发生漂移，无法精确匹配 $I_{REF}$。
2.  **输出电阻问题：** 当电流镜用作放大器的有源负载时，我们希望其 $R_{out}$ 越大越好（因为电压增益 $A_v \propto R_{out}$）。但普通电流镜的 $R_{out}$ 仅为 $r_{ds2}$，不够大。

**【核心概念/解决方案】** **共源共栅 (Cascode)** 结构正是为了解决上述两个痛点而生。

*   **Cascode 的本质：** 在一个普通的共源（$M_2$）管的漏极上，再串联一个共栅（$M_3$）管。这个堆叠动作，就像给电流镜加了一个“**高阻抗屏蔽层**”**（如图 4b 所示）**。
*   **消除 $\lambda$ 效应的原理：** $M_3$ 保持了 $M_2$ 的漏极电压 $V_A$ 几乎不变（$V_A = V_C - V_{GS3}$）。即使外部负载电压 $V_{OUT}$ 变化很大，由于 $V_A \approx V_B$，管子 $M_2$ 的 $V_{DS2}$ 也能保持高度恒定。$V_{DS}$ 不变，$\lambda$ 效应自然得到有效抑制，输出电流精度大大提高。
![[Pic/Pasted image 20251031142159.png]]
[图 4：此处应为原文中 Cascode 电流镜的基本结构图 (a) 普通电流镜和 (b) Cascode 电流镜]

#### 3.5.2 Cascode 结构的性能飞跃

**【关键技能/核心考点：输出电阻 $R_{out}$】**

Cascode 结构最显著的优势是对 $R_{out}$ 的巨大提升。

*   **物理意义：** $M_3$ 作为共栅级，其本质是一个电流缓冲器，具有极高的输出电阻。它将 $M_2$ 的输出电阻 $r_{ds2}$ **“放大”** 了 $M_3$ 的电压增益倍。
*   **最终结论：**
    $$\boxed{R_{out, cascode} \approx g_{m3} r_{ds3} \cdot r_{ds2}}$$
    **一句话总结：** $R_{out}$ 近似于普通电流镜 $r_{ds2}$ 乘以 Cascode 级 $M_3$ 的固有增益 $g_{m3} r_{ds3}$。这个增益因子通常在 $10 \sim 100$ 之间（**如 Slide 11 所示**），实现了 $R_{out}$ 数量级的飞跃。

**【关键技能/核心考点：电压余度（Headroom）】**

高增益是有代价的。Cascode 结构的主要缺点是**消耗了较大的电压余度（Voltage Headroom）**。

*   **痛点：** 为了让 $M_2$ 和 $M_3$ 都工作在**饱和区**（这是保证高 $R_{out}$ 的前提），输出电压 $V_L$ 必须满足最小要求 $V_{L,min}$。
*   **最小电压要求：**
    $$\boxed{V_{L,min} \ge 2V_{eff} + V_{TH}}$$
    **一句话总结：** $V_L$ 至少需要大于两个管子的过驱动电压 $V_{eff}$ 之和，再加上一个阈值电压 $V_{TH}$。这使得 Cascode 结构不适合在低电源电压（Low $V_{DD}$）环境下工作，因为它**极大地限制了输出电压的摆幅 (Output Swing)**。

[图 8/9：此处应为原文中 Cascode 电流镜的最小电压要求和总结图]

#### 3.5.3 改进：宽摆幅 Cascode (Wide-Swing Cascode)

**【背景故事/优化】** 为了克服传统 Cascode 在低电压下的应用限制，我们引入了**宽摆幅 Cascode** 结构。

*   **核心目标：** 在保持 $M_2, M_3$ 饱和工作，以及高 $R_{out}$ 的前提下，尽可能降低最小输出电压 $V_{L,min}$。
*   **优化结果 (NMOS 示例)：** 通过巧妙地设置偏置电压 $V_b$，可以将 $V_{L,min}$ 降低至：
    $$\boxed{V_{L,min} \approx 2V_{eff}}$$
    **一句话总结：** 最小电压要求**消除了一个阈值电压 $V_{TH}$**，这在低 $V_{DD}$ 电路中至关重要。

![[Pic/Pasted image 20251031192521.png]]
[图 14：此处应为原文中 Wide-Swing Cascode (NMOS) 的最终结论图]

---

### 3.6 共源共栅放大器 (Cascode Amplifier)

**【知识回顾与连接】** 正如 Cascode 结构能极大提升电流镜的 $R_{out}$ 从而提高其作为电流源的精度，当它被用作放大器时，同样会带来巨大的增益提升，因为 $A_v \propto R_{out}$。

#### 3.6.1 经典套筒式 Cascode (Telescopic-Cascode AMP)

**【核心概念/重点】** 套筒式 Cascode 放大器**（如图 18 所示）**是最基本的 Cascode 放大器结构。
*   **结构：** 输入管 $M_1$ 是共源级，其负载是一个共栅管 $M_2$。$M_2$ 上方是有源负载（例如 Cascode 电流镜）。
![[Pic/Pasted image 20251031194429.png]]
[图 18：此处应为原文中 Telescopic-Cascode AMP 的 NMOS 和 PMOS 结构图]

| 优点 (与普通 CS 相比)                                                 | 缺点 (与普通 CS 相比)               |
| :------------------------------------------------------------- | :--------------------------- |
| **极高的输出电阻 $R_{out}$** 和 **极高的电压增益 $A_v$**。                     | **输出电压摆幅 (Output Swing) 小。** |
| 极大地**消除了输入管 $M_1$ 的米勒效应**（$C_{gd}$ 影响），改善了高频特性（**见 3.7.3 节**）。 | **不适合低电源电压电路。**              |

#### 3.6.2 折叠式 Cascode (Folded-Cascode AMP)

**【背景故事/优化】** 套筒式 Cascode 摆幅太小，不适合作为高要求的运算放大器 (Op-Amp) 的第一级。因此，我们引入了**折叠式 Cascode**。

*   **核心创新 (折叠点)：** 通过引入一个额外的直流偏置电流源 $I_{bias}$ (Current Mirror)，将输入管 $M_1$ 的漏极电流“折叠”并引入到 PMOS Cascode 结构中**（如图 29/30 所示）**。
*   **结构优势：**
    1.  **输入与输出的直流电平接近：** 输入管 $M_1$（通常为 NMOS）的源极接地，而 Cascode 级 $M_2$（通常为 PMOS）的源极接 $V_{DD}$，这使得输入和输出的直流工作点可以更容易地设置在**靠近中间电源**的位置，从而**大大提高了输出电压摆幅**（这是运算放大器最看重的特性之一）。
    2.  **保留高 $R_{out}$ 和高 $A_v$ 的优点。**
    3.  **消除米勒效应 (Miller Effect)。**
![[Pic/Pasted image 20251031194612.png]]
[图 29/30：此处应为原文中 Folded-Cascode AMP 的结构图]

**【折叠式 Cascode 总结 (Slide 36)】**

$$\boxed{\text{折叠式 Cascode 适用于运算放大器 (Op-Amp)}}$$
**一句话总结：** 虽然折叠式 Cascode 的增益 $A_v$ 和功耗略逊于套筒式，但它具有**更大的输出摆幅**和**相近的输入/输出直流电平**，使其成为 Op-Amp 中最受欢迎的结构。

---

### 3.7 放大器的频率特性：速度的极限

**【背景故事/为什么会变慢】** 无论是 Cascode 还是普通 CS 放大器，其性能都会随着频率升高而下降。

*   **本质原因：** 主要由 CMOS 元器件内部和布线产生的**寄生电容**（$C_{gs}, C_{gd}, C_{db}$ 等）决定。在高频下，这些电容不再是开路，它们会存储电荷，限制信号的快速变化，导致：
    1.  电压增益下降。
    2.  相位发生滞后或超前（偏离 $\pm 180^\circ$）。
    3.  瞬态响应速度变慢。

#### 3.7.1 知识回顾：传递函数、极点与零点

**【核心概念/重点】** 系统的频率特性由**极点 (Pole)** 和**零点 (Zero)** 决定。
*   **传递函数 $H(s)$：** 描述系统输出 $V_{out}(s)$ 与输入 $V_{in}(s)$ 关系的函数。
    $$H(s) = H_0 \frac{(s+z_1)\cdots(s+z_m)}{(s+p_1)\cdots(s+p_n)}$$
*   **极点 $p_n$ (Pole)：** 位于 $s$ 平面左半平面的极点导致增益在**高频下降**，并产生**相移滞后**（最多 $-90^\circ$）。
*   **零点 $z_m$ (Zero)：** 位于 $s$ 平面左半平面的零点导致增益在**高频上升**，并产生**相移超前**（最多 $+90^\circ$）。右半平面零点会引起非最小相位，在模拟电路中需要避免。
*   **带宽 (Bandwidth)：** 通常指增益下降到最大值 $\frac{1}{\sqrt{2}}$ （即 $-3\text{dB}$）时的频率 $\omega_{-3\text{dB}}$。在多极点系统中，**距离原点最近的那个极点 $\omega_{p1}$ (Dominant Pole)** 往往决定了带宽。
![[Pic/Pasted image 20251031201254.png]]
![[Pic/Pasted image 20251031201301.png]]
[图 39-41：此处应为原文中极点/零点对波特图的影响图]

#### 3.7.2 CS 放大器的“速度瓶颈”：米勒效应

**【关键技能/核心考点：共源极放大器 (CS AMP) 的瓶颈】**
*   **结构：** 如图 42 所示，CS 放大器的输入端 $V_{in}$ 和输出端 $V_{out}$ 之间存在一个寄生电容 $C_{gd1}$。
*   **米勒效应 (Miller Effect)：** 由于 $V_{out} = -A_v V_{in}$，这个跨接在输入和输出之间的小电容 $C_{gd1}$，会在输入端**等效出一个非常大的电容** $C_{in, Miller}$。

$$\boxed{\text{米勒效应：} C_{in, Miller} \approx C_{gd1} \cdot (1 + |A_v|)}$$
**一句话总结：** CS 放大器的电压增益 $A_v$ 越大，这个等效电容 $C_{in, Miller}$ 就越大。

*   **后果：** 巨大的 $C_{in, Miller}$ 与输入端的等效电阻 $R_S$ 形成一个 $RC$ 低通网络，产生一个**距离原点很近（频率很低）的极点 $\omega_{p1}$**，从而**严重限制了 CS 放大器的带宽**。

[图 42：此处应为原文中 CS 放大器的小信号等效电路图]

#### 3.7.3 Cascode 放大器的“速度突破”

**【核心概念/Cascode 为什么快】**

Cascode 放大器在高频性能上的最大优势，正是它能**有效抑制米勒效应**。
1.  **隔离作用：** 在 Cascode 结构中，输入管 $M_1$（共源极）的漏极（$V_A$ 点）不再直接连接到输出 $V_{out}$，而是连接到一个低阻抗点（$M_2$ 的源极 $V_{S2}$）。
2.  **低增益：** 由于 $M_2$ 是共栅级，它将 $M_1$ 的负载 $R_{out1}$ 转换为 $M_2$ 的输入电阻 $1/g_{m2}$。因此，**$M_1$ 这一级的电压增益 $|A_{v1}|$ 变得非常小（接近 1）**。
3.  **米勒效应被抑制：** 根据米勒效应公式 $C_{in, Miller} \approx C_{gd1} \cdot (1 + |A_{v1}|)$，当 $|A_{v1}|$ 接近 1 时，输入电容 $C_{gd1}$ 仅被放大了 $\approx 2 \sim 3$ 倍，而不是被总增益 $|A_v|$ 放大。
4.  **带宽增加：** 由于 $M_1$ 的输入电容大大减小，**决定带宽的主极点 $\omega_{p1}$ 被推向了更高的频率**，从而实现了 Cascode 放大器的高带宽特性。

$$\boxed{\text{Cascode 的频率优势：}} \text{Cascode 结构将高电压增益与输入端隔离，抑制了米勒效应，使主极点向高频移动，实现高带宽。}$$

[图 52/53：此处应为原文中 Cascode 放大器的极点估算图]

#### 3.7.4 源极跟随器 (Source Follower) 的频率特性

**【知识回顾/连接】** 源极跟随器（共漏级 CD）的电压增益 $|A_v| \approx 1$。
*   **米勒效应：** 由于 $|A_v| \approx 1$，它跨接在输入和输出之间的 $C_{gd}$ **几乎不受米勒效应影响**。
*   **频率特点 (Slide 50)：** 因此，源极跟随器（CD 放大器）的第一个极点 $\omega_{p1}$ **远大于** 共源放大器的 $\omega_{p1}$，这使得它的带宽非常宽，具有优异的高频特性。